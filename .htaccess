# OSK Łuczak - Konfiguracja serwera
# Umieść ten plik w głównym folderze strony

# ================================
# REWRITE ENGINE
# ================================
RewriteEngine On

# ================================
# 1. WYMUSZENIE HTTPS
# ================================
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# ================================
# 2. PRZEKIEROWANIE WWW NA BEZ-WWW
# ================================
RewriteCond %{HTTP_HOST} ^www\.oskluczak\.pl [NC]
RewriteRule ^(.*)$ https://oskluczak.pl/$1 [L,R=301]

# ================================
# 3. PRZEKIEROWANIA STARYCH URL
# ================================
RewriteRule ^o-firmie\.html$ /o-szkole [L,R=301]
RewriteRule ^o-firmie$ /o-szkole [L,R=301]
RewriteRule ^cennik\.html$ /oferta [L,R=301]
RewriteRule ^cennik$ /oferta [L,R=301]

# ================================
# 4. USUŃ index.html Z URL GŁÓWNEJ
# ================================
RewriteCond %{THE_REQUEST} /index\.html [NC]
RewriteRule ^index\.html$ / [L,R=301]

# ================================
# 4. USUŃ .html Z INNYCH STRON
# ================================
RewriteCond %{THE_REQUEST} \.html [NC]
RewriteRule ^(.*)\.html$ /$1 [L,R=301]

# ================================
# 5. OBSŁUGA URL BEZ .html
# ================================
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME}.html -f
RewriteRule ^(.*)$ $1.html [L]

# ================================
# DOMYŚLNY DOKUMENT
# ================================
DirectoryIndex index.html

# ================================
# STRONA BŁĘDU 404
# ================================
ErrorDocument 404 /404.html

# ================================
# KOMPRESJA GZIP
# ================================
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/json
</IfModule>

# ================================
# CACHE PRZEGLĄDARKI
# ================================
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/svg+xml "access plus 1 year"
    ExpiresByType image/webp "access plus 1 year"
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    ExpiresByType text/javascript "access plus 1 month"
</IfModule>

# ================================
# ZABEZPIECZENIA
# ================================
<Files .htaccess>
    Order allow,deny
    Deny from all
</Files>

<FilesMatch "(^\.git|\.env|composer\.(json|lock))$">
    Order allow,deny
    Deny from all
</FilesMatch>
